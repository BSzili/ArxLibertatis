Failat 21

SetEnv patch_file "ArxFatalis_1.21_EN.exe"

; retail CD
SetEnv install_path "Arx Fatalis:"

; RPG Compilation DVD
If Not Exists "${install_path}setup1.cab"
  SetEnv install_path "RPGCompilation:arx/"
EndIf

If Not Exists "${install_path}setup1.cab"
  RequestChoice >ENV:Choicex Title="Error" Body="Can't find the Arx Fatalis CD" Gadgets=OK
  Quit
EndIf

If Not Exists ${patch_file}
  RequestChoice >ENV:Choicex Title="Error" Body="Can't find patch: ${patch_file}" Gadgets=OK
  Quit
EndIf

; copy data from the CD
xadUnFile "${install_path}setup1.cab" "" OVERWRITE
xadUnFile "${install_path}setup2.cab" "" OVERWRITE
xadUnFile "${install_path}setup3.cab" "" OVERWRITE
copy "${install_path}bin/data2.pak" "" NOPRO
copy "${install_path}bin/LOC.pak" "" NOPRO

; extract patch
innoextract ${patch_file}

; copy the extacted data
Copy FROM app/#? TO "" ALL MOVE
; Copy FROM app/#? TO "" ALL
Delete app ALL

; delete some unnecessary files from the patch
Delete arx.exe
Delete ARX_SCRIPT_DEBUGGER.DLL
Delete Athena.dll
Delete game.ico
Delete innosetup_license.txt
Delete instscript.vdf
Delete MD5_MIT_license.txt
Delete unicows.dll
